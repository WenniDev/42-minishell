tmpin = dup STDIN
tmpout = dup STDOUT

pipe

infd = dup tmpin | red | pipe0
outfd = dup tmpout | red | pipe1

dup2 infd, STDIN
dup2 outfd, STDOUT
close outfd

fork
child -> close all
parent ->